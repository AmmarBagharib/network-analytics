---
title: "individual project"
author: "Ammar"
date: "2023-09-03"
output: 
  bookdown::html_document2:
      toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r message=FALSE, warning=FALSE}
library(igraph)
library(here)
library(data.table)
```

# Graph summary

```{r Summary}
# Step 1: Read the edge list from the .txt file
file_path_2000 <- here("indiv-project/trade-network/2000.net")
g2000 <- read_graph(file_path_2000,format="pajek")

str(g2000)
```

# Graph Level Attributes

## Absolute attributes check

**Number of Nodes:** `r vcount(g2000)`

**Number of Edges:** `r ecount(g2000)`

**Graph Density:** `r graph.density(g2000)`

**Graph Diameter:** `r diameter(g2000)`

**Size of largest Component:** `r max(components(g2000)$csize)`

**Global Transitivity:** `r transitivity(g2000,type="global")`

**Average Transitivity** `r transitivity(g2000,type="average") `

**Size of Largest Clique:** `r clique_num(g2000)`

**Diameter of Graph:** `r diameter(g2000)`


### Review

There are 161 countries represented in the trade network and a total of 16,335 trade relationships (edges) in the network, indicating a **relatively dense** network.The graph density is approximately 0.634, which suggests that about 63.4% of all possible trade relationships between countries are present. This indicates a **relatively connected** network. The diameter of the graph is 558.699. This represents the longest shortest path between any two countries in the trade network, which is a measure of the network's overall size.

The entire network forms a single connected component with all 161 countries, indicating that there are **no isolated subnetworks**.The global transitivity (clustering coefficient) is approximately 0.842, suggesting that there is a **significant tendency** for groups of countries to engage in trade with one another, forming clusters or communities within the network. The average transitivity is approximately 0.871, which is similar to the global transitivity. This further confirms a **high degree of clustering** within the network. The largest clique in the network consists of 81 countries. This indicates the **presence of a highly interconnected group of countries** that trade extensively with each other.

# Vertex Attributes

```{r Attributes}
# store attributes into a data.frame
df=data.frame(vertex_id=V(g2000),
              vertex_name=V(g2000)$name,
              degree=degree(g2000),
              closeness=closeness(g2000),
              betweenness=betweenness(g2000,normalized=T),
              transitivity=transitivity(g2000,type="local"),
              eigen_centrality=eigen_centrality(g2000)$vector
              )
knitr::kable(
  summary(df[-c(1,2)]),
  caption = "Vertex Attributes"
)
```

### Review

**Betweenness Centrality:** 

- Betweenness centrality measures how often a country acts as a bridge or intermediary in trade relationships between other countries. The values range from 0 to a maximum of 0.236006, indicating variations in the importance of countries in facilitating trade routes.

- The values are still pretty much quite low, indicating that most countries do not rely on thir party channels to do trade with a country of interest.

**Transitivity:**

- The values range from 0.7591 to 0.9933, suggesting that many countries form tightly interconnected groups in trade networks.


## Degree Distribution

```{r fig.cap="Degree Distribution"}
hist_deg <- hist(
  degree(g2000),
  main="Degree Distribution",
  xlab="Degree",
  ylab="Number of Countries"
  )

hist_deg_df <- data.frame(
  Midpoint = hist_deg$mids,
  Frequency = hist_deg$counts
)

knitr::kable(hist_deg_df, caption = "Degree Histogram Bins Table")
```

### Review

Here's a brief description of the degree distribution:

Based on Table 3.2
The degree distribution provides insights into how countries in the trade network are connected or how many connections (edges) they have. The midpoint values represent the central values of degree ranges or bins.

- The frequency column shows that the majority of nodes in the network have degrees between 151 and 250 (175-225 midpoint), as this bin has the highest frequency of 42 nodes.

- There is a moderate number of nodes with degrees between 101 and 150 (125-175 midpoint) and between 251 and 300 (275-325 midpoint).

- There are fewer nodes with degrees below 100 or above 300.

When looking purely at degree, this distribution suggests that a **substantial** number of nodes have a **moderate** degree of connectivity, while a **smaller** number of nodes have either **low or high degrees**.

## Closeness Distribution

```{r fig.cap="Closeness Distribution"}
hist(
  closeness(g2000),
  main="Closeness Distribution",
  xlab="Closeness",
  ylab="Number of Countries"
  )
```


```{r fig.cap="Filtered Closeness Distribution"}
#closeness for each node - there are NaN values
closeness_values <- closeness(g2000)

# Find vertices with NaN closeness centrality
nan_vertices <- which(is.nan(closeness_values))

# Remove vertices with NaN closeness centrality from the graph
g2000_filtered <- delete.vertices(g2000, nan_vertices)

hist_closeness <- hist(
  closeness(g2000_filtered),
  breaks=seq(0,max(closeness(g2000_filtered))+ 0.00005,by=0.00005),
  xlim=c(0.0006, 0.00105),
  main="Closeness Distribution",
  xlab="Closeness",
  ylab="Number of Countries"
  )

hist_closeness_df <- data.frame(
  Midpoint = hist_closeness$mids,
  Frequency = hist_closeness$counts
)

knitr::kable(hist_closeness_df, caption = "Closeness Histogram Bins Table")
```


### Review

Overall, the closeness centrality values are generally very low, with a maximum of no more than 0.0012. Nonetheless, here are some findings:

Based on Table 3.3
- 121 out of 161 countries have closeness centrality of between 0.000775 and 0.000975, which is relatively very high.

- Only 1 country is within the highest closeness centrality bin of 0.001175, indicating that it is very well-connected and have shorter average distances to other countries, indicating strong trade relationships. This can mean that it in the year 2000, it was a Trade Global powerhouse.

- The presence of 19 countries with missing closeness centrality values suggests that these countries may have limited closeness centrality due to their relative isolation in trade. They may have a limited number of trade partners or may not have any direct trade relationships with other countries. In such cases, the country's closeness centrality could be NaN because there are no paths to reach it from other countries.

- The trade network may consist of multiple connected components, with some countries forming isolated sub-networks. Countries within such isolated components may have NaN closeness centrality values.

## Eigen Centrality

```{r fig.cap="Eigen Centrality"}
hist(
  eigen_centrality(g2000)$vector,
  main="Eigen Centrality Distribution",
  xlab="Eigen Centrality",
  ylab="Number of Countries"
  )
```

```{r fig.cap="subset of Eigen Centrality" }
hist(
  eigen_centrality(g2000)$vector,
  breaks=seq(0,max(eigen_centrality(g2000)$vector)+ 0.00005,by=0.001),
  xlim=c(0, 0.01),
  main="Eigen Centrality Distribution",
  xlab="Eigen Centrality",
  ylab="Number of Countries"
  )
```

### Review

Based on Fig 3.5
Approximately 60 countries have eigen centrality values of between 0 to 0.001, and this forms the majority of the countries.  

- Countries with eigen centrality values in this range are likely to be peripheral or less influential in the global trade network. They may have limited trade connections or trade relationships that are not strongly influential on a global scale.

- These countries may not play a significant role in shaping global trade patterns. They might have relatively small trade volumes or trade primarily with a limited set of partners.

- Their influence on the network's structure and dynamics is relatively low, and they are less likely to act as intermediaries in trade routes.

The second largest group of countries, approximately 20, have eigen centrality values of between 0.001 to 0.002.

- Countries falling within this range have a somewhat more significant influence on the trade network compared to those in the lower eigen centrality range. They may have more extensive trade connections and contribute to regional trade patterns.

- These countries may play key roles in regional trade blocs or economic partnerships, influencing trade dynamics within their respective regions.

- While not among the most influential in the global trade network, they have a moderate degree of influence on the network's structure and connectivity.
